<html>
	<head>
		<title>Play Nine</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<style type="text/css">

			.fa-star {
				margin: 0.5em;
				font-size: 24px;
			}

			span {
				display: inline-block;
				margin: 0.5em;
				text-align: center;
				background-color: #ccc;
				width: 24px;
				border-radius: 50%;
				cursor: pointer;
			}

			.selected {
				background-color: #eee;
				color: #ddd;
				cursor: not-allowed;
			}

			.used {
				background-color: #aaddaa;
				color: #99bb99;
				cursor: not-allowed;
			}

		</style>
	</head>
	<body>
	    <div id="root"></div>
	    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js"></script>
	    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
	    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
	    <script crossorigin src="https://unpkg.com/@babel/standalone@7.1.0/babel.min.js"></script>
	    <script type="text/babel">

	    const Stars = (props) => {
	    	return (
	    		<div className="col-5">
	    			{_.range(props.numberOfStars).map(i => <strong key={i} className="fa fa-star">&#9733;</strong>)}
	    		</div>
	    	);
	    };

	    const Button = (props) => {
	    	let button;
	    	switch(props.answerIsCorrect) {
	    		case true:
	    			button = <button className="btn btn-success" onClick={props.acceptAnswer}> <strong>&#9745;</strong> </button>
	    		break;
	    		case false:
	    			button = <button className="btn btn-danger"> <strong>&#9747;</strong> </button>
	    		break;
	    		default:
	    			button = <button className="btn" onClick={props.checkAnswer} disabled={props.selectedNumbers.length === 0}> = </button>
	    		break;
	    	}
	    	return (
	    		<div className="col-2">
	    			{button}
	    		</div>
	    	);
	    };

	    const Answer = (props) => {
	    	return (
	    		<div className="col-5">
	    			{props.selectedNumbers.map((number, i) => <span key={i} onClick={() => props.unselectNumber(number)}>{number}</span>)}
	    		</div>
	    	);
	    };

	    const Numbers = (props) => {
	    	const numberClassName = (number) => {
	    		if(props.selectedNumbers.indexOf(number) >= 0) {
	    			return 'selected';
	    		}
	    		if(props.usedNumbers.indexOf(number) >= 0) {
	    			return 'used';
	    		}
	    	}
	    	return (
	    		<div className="card text-center">
	    			<div>
	    				{Numbers.list.map((number, i) => <span key={i} className={numberClassName(number)} onClick={() => props.selectNumber(number)}>{number}</span> )}
	    			</div>
	    		</div>
	    	);
	    };

	    Numbers.list = _.range(1,10);

	    class Game extends React.Component {
	    	
	    	state = {
	    		selectedNumbers: [],
	    		randomNumberOfStars: 1 + Math.floor(Math.random() * 9),
	    		usedNumbers: [],
	    		answerIsCorrect: null
	    	};

	    	selectNumber = (clickedNumber) => {
	    		if(this.state.selectedNumbers.indexOf(clickedNumber) >= 0) { return; }
	    		this.setState(prevState => ({
	    			answerIsCorrect: null,
	    			selectedNumbers: prevState.selectedNumbers.concat(clickedNumber)
	    		}));
	    	};

	    	unselectNumber = (clickedNumber) => {
	   			this.setState(prevState => ({
	   				answerIsCorrect: null,
	   				selectedNumbers: prevState.selectedNumbers.filter(number => number !== clickedNumber)
	   			}));
	    	};

	    	checkAnswer = () => {
	    		this.setState(prevState => ({
	    			answerIsCorrect: prevState.randomNumberOfStars === prevState.selectedNumbers.reduce((acc, n) => acc + n, 0)
	    		}));
	    	};

	    	acceptAnswer = () => {
	    		this.setState(prevState => ({
	    			usedNumbers: prevState.usedNumbers.concat(prevState.selectedNumbers),
	    			selectedNumbers: [],
	    			answerIsCorrect: null,
	    			randomNumberOfStars: 1 + Math.floor(Math.random() * 9)
	    		}));
	    	};

	    	render() {
	    		const { selectedNumbers, randomNumberOfStars, answerIsCorrect, usedNumbers, acceptAnswer } = this.state;
	    		return (
	    			<div className="container">
	    				<h3>Play Nine</h3>
	    				<hr />
	    				<div className="row">
	    					<Stars numberOfStars={randomNumberOfStars} />
	    					<Button selectedNumbers={selectedNumbers} checkAnswer={this.checkAnswer} answerIsCorrect={answerIsCorrect} acceptAnswer={acceptAnswer} />
	    					<Answer selectedNumbers={selectedNumbers} unselectNumber={this.unselectNumber} />
	    				</div>
	    				<br />
	    				<Numbers selectedNumbers={selectedNumbers} selectNumber={this.selectNumber} usedNumbers={usedNumbers} />
	    			</div>
	    		);
	    	}
	    }

	    class App extends React.Component {
	    	render() {
	    		return (
	    			<div>
	    				<Game />
	    			</div>
	    		);
	    	}
	    }


	    ReactDOM.render(<App />, document.getElementById('root'));

	    </script>
	</body>
</html>